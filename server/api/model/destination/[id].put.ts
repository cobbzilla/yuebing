// DO NOT EDIT THIS FILE. AUTO-GENERATED BY mobiletto-orm-typedef-gen

import { DestinationType, DestinationTypeDef } from "yuebing-model";

export default defineEventHandler(async (event) => {
  filterErrors(event, "destination.create", async (event) => {
    requireAdminAccountObject(event, "destination.create", async (event, session, account) => {
      const id = event.context.params.id;
      const destinationRepo = destinationRepository();
      const obj: DestinationType = await readBody(event);
      if (!obj) {
        throw createError({ statusCode: 400, statusMessage: "bad request" });
      }
      if (DestinationTypeDef.id(obj) !== id) {
        throw createError({ statusCode: 422, statusMessage: "validation error", data: { id: ["mismatch"] } });
      } else {
        return await destinationRepo.create(obj);
      }
    });
  });
});
