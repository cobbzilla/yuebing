// DO NOT EDIT THIS FILE. AUTO-GENERATED BY mobiletto-orm-typedef-gen

import { LibraryType, LibraryTypeDef } from "yuebing-model";

export default defineEventHandler(async (event) => {
  filterErrors(event, "library.update", async (event) => {
    requireAdminAccountObject(event, "library.update", async (event, _session, _account) => {
      const id = event.context.params.id;
      const libraryRepo = libraryRepository();
      const obj: LibraryType = await readBody(event);
      if (!obj) {
        throw createError({ statusCode: 400, statusMessage: "bad request" });
      }
      if (LibraryTypeDef.id(obj) !== id) {
        throw createError({ statusCode: 422, statusMessage: "validation error", data: { id: ["mismatch"] } });
      } else {
        return await libraryRepo.update(obj);
      }
    });
  });
});
